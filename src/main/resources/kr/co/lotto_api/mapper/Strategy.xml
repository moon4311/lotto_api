<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.lotto_api.mapper.Strategy">
 
 	<!--  추출 건수 조회 -->
 	<select id="selectCnt" parameterType="map" resultType="int">
		SELECT 	count(1)
		FROM 		LOTTO_NO_REDUCE_TB
		WHERE ball_no1 <![CDATA[ <= ]]> #{firstNo}
		and ball_no2 <![CDATA[ <= ]]> #{secondNo}
		and ball_no5 <![CDATA[ >= ]]> #{fiveNo}
		and ball_no6 <![CDATA[ >= ]]> #{lastNo}
		and sum between #{sumMin} and #{sumMax}
		and odd_cnt in (2,3,4,5)
		and ball_no1 in ( <foreach collection="noList" item="no" separator=",">#{no}</foreach>	)
		and ball_no2 in ( <foreach collection="noList" item="no" separator=",">#{no}</foreach>	)
		and ball_no3 in ( <foreach collection="noList" item="no" separator=",">#{no}</foreach>	)
		and ball_no4 in ( <foreach collection="noList" item="no" separator=",">#{no}</foreach>	)
		and ball_no5 in ( <foreach collection="noList" item="no" separator=",">#{no}</foreach>	)
		and ball_no6 in ( <foreach collection="noList" item="no" separator=",">#{no}</foreach>	)
	</select>
 	<!--  추출 목록 조회 -->
 	<select id="selectList" parameterType="map" resultType="LottoNoVO">
		SELECT 	RAND(),
						BALL_NO1,
						BALL_NO2,
						BALL_NO3,
						BALL_NO4,
						BALL_NO5,
						BALL_NO6
		FROM 		LOTTO_NO_REDUCE_TB
		WHERE ball_no1 <![CDATA[ <= ]]> #{firstNo}
		AND ball_no2 <![CDATA[ <= ]]> #{secondNo}
		AND ball_no5 <![CDATA[ >= ]]> #{fiveNo}
		AND ball_no6 <![CDATA[ >= ]]> #{lastNo}
		AND sum between #{sumMin} and #{sumMax}
		AND ball_no1 in ( <foreach collection="noList" item="no" separator=",">#{no}</foreach>	)
		AND ball_no2 in ( <foreach collection="noList" item="no" separator=",">#{no}</foreach>	)
		AND ball_no3 in ( <foreach collection="noList" item="no" separator=",">#{no}</foreach>	)
		AND ball_no4 in ( <foreach collection="noList" item="no" separator=",">#{no}</foreach>	)
		AND ball_no5 in ( <foreach collection="noList" item="no" separator=",">#{no}</foreach>	)
		AND ball_no6 in ( <foreach collection="noList" item="no" separator=",">#{no}</foreach>	)
		ORDER BY 1
		LIMIT ${limit}
	</select>
	
	
</mapper>